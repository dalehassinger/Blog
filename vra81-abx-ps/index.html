<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>vRealize Automation 8.1 - PowerShell ABX - vCROCS</title><meta name="Description" content="Enterprise Automation, Monitoring and Logging. Plus more..."><meta property="og:url" content="https://www.vcrocs.info/vra81-abx-ps/">
  <meta property="og:site_name" content="vCROCS">
  <meta property="og:title" content="vRealize Automation 8.1 - PowerShell ABX">
  <meta property="og:description" content="Options to use PowerShell Modules">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-05-17T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-10-17T09:08:38-04:00">
    <meta property="article:tag" content="PowerShell">
    <meta property="article:tag" content="VRA">
    <meta property="article:tag" content="ABX">
    <meta property="article:tag" content="VRealize Automation">
    <meta property="article:tag" content="VMware Aria">
    <meta property="og:image" content="https://www.vcrocs.info/vra81-abx-ps/featured-image.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://www.vcrocs.info/vra81-abx-ps/featured-image.png">
  <meta name="twitter:title" content="vRealize Automation 8.1 - PowerShell ABX">
  <meta name="twitter:description" content="Options to use PowerShell Modules">
      <meta name="twitter:site" content="@dalehassinger">
<meta name="application-name" content="vCROCS">
<meta name="apple-mobile-web-app-title" content="vCROCS"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="canonical" href="https://www.vcrocs.info/vra81-abx-ps/" /><link rel="prev" href="https://www.vcrocs.info/hugo/" /><link rel="next" href="https://www.vcrocs.info/it-reality/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "vRealize Automation 8.1 - PowerShell ABX",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.vcrocs.info\/vra81-abx-ps\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/www.vcrocs.info\/vra81-abx-ps\/featured-image.png",
                            "width":  1420 ,
                            "height":  708 
                        }],"genre": "posts","keywords": "PowerShell, vRA, ABX, vRealize Automation, VMware Aria","wordcount":  863 ,
        "url": "https:\/\/www.vcrocs.info\/vra81-abx-ps\/","datePublished": "2020-05-17T00:00:00+00:00","dateModified": "2023-10-17T09:08:38-04:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/www.vcrocs.info\/images\/avatar.png",
                    "width":  528 ,
                    "height":  560 
                }},"author": {
                "@type": "Person",
                "name": "Dale Hassinger"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7670183691519835" crossorigin="anonymous"></script>
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="vCROCS"><span class="header-title-pre"><i class='far fa-house fa-solid'></i></span>vCROCS</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/links/" title="Links"><i class='fab fa-bookmark fa-regular' aria-hidden='true'></i>  </a><a class="menu-item" href="/pics/" title="Pics"><i class='fab fa-image fa-regular' aria-hidden='true'></i>  </a><a class="menu-item" href="https://twitter.com/dalehassinger" title="Twitter" rel="noopener noreffer" target="_blank"><i class='fab fa-twitter'></i>  </a><a class="menu-item" href="https://www.youtube.com/playlist?list=PLqjVNzdDCzwZXR3lfqaFX_hZI3zB8nsVF" title="Podcast" rel="noopener noreffer" target="_blank"><i class='fa fa-podcast fa-fw' aria-hidden='true'></i>  </a><a class="menu-item" href="/disclaimer/" title="Disclaimer"><i class='fa-regular fa-file' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7670183691519835" crossorigin="anonymous"></script>
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="vCROCS"><span class="header-title-pre"><i class='far fa-house fa-solid'></i></span>vCROCS</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/links/" title="Links"><i class='fab fa-bookmark fa-regular' aria-hidden='true'></i></a><a class="menu-item" href="/pics/" title="Pics"><i class='fab fa-image fa-regular' aria-hidden='true'></i></a><a class="menu-item" href="https://twitter.com/dalehassinger" title="Twitter" rel="noopener noreffer" target="_blank"><i class='fab fa-twitter'></i></a><a class="menu-item" href="https://www.youtube.com/playlist?list=PLqjVNzdDCzwZXR3lfqaFX_hZI3zB8nsVF" title="Podcast" rel="noopener noreffer" target="_blank"><i class='fa fa-podcast fa-fw' aria-hidden='true'></i></a><a class="menu-item" href="/disclaimer/" title="Disclaimer"><i class='fa-regular fa-file' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">vRealize Automation 8.1 - PowerShell ABX</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://twitter.com/dalehassinger" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Dale Hassinger</a></span>&nbsp;<span class="post-category">included in <a href="/categories/vrealize-automation/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>VRealize Automation</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2020-05-17">2020-05-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;863 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/vra81-abx-ps/featured-image.png"
        data-srcset="/vra81-abx-ps/featured-image.png, /vra81-abx-ps/featured-image.png 1.5x, /vra81-abx-ps/featured-image.png 2x"
        data-sizes="auto"
        alt="/vra81-abx-ps/featured-image.png"
        title="/vra81-abx-ps/featured-image.png" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li>
              <ul>
                <li>
                  <ul>
                    <li><a href="#blueprint-requirements">BluePrint Requirements:</a></li>
                    <li><a href="#what-i-created-to-accomplish-the-requirements">What I created to accomplish the requirements:</a></li>
                    <li><a href="#sample-code-and-screen-shots---">Sample Code and Screen Shots:&mdash;</a></li>
                    <li><a href="#blueprint">BluePrint:</a></li>
                    <li><a href="#action">Action:</a></li>
                    <li><a href="#subscription">Subscription:</a></li>
                    <li><a href="#lets-compare-vra-76-vs-81">Lets compare vRA 7.6 vs 8.1</a></li>
                    <li><a href="#lessons-learned">Lessons Learned:</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p><strong>Options to use PowerShell Modules</strong></p>
<hr>
<p>I wanted to review VMware vRA (vRealize Automation) 8.x as a Microsoft Windows Server Admin.  Most of the reviews you see are creating Linux VMs and customizing the OS using tools for Linux. I am going to create Windows Server VMs and customize the OS using a new feature added to vRA 8.1, Action Based Extensibility (ABX) with PowerShell. No vRO (Orchestrator) Workflows will be used. This is completely different compared to how I create Windows Servers with vRA 7.6.</p>
<p>The enterprise organizations that I have worked for are 90%+ Microsoft Windows Servers.  It is important for me to have vRA be able to create Windows Servers and make all configuration changes using PowerShell.</p>
<p>You could also use this technique to make changes to a Linux VM using the PowerCLI commands Invoke-VMscript and Copy-VMGuestFile. I did create a <a href="../automation-zero-trust/" rel="">Blog Post</a> on this topic.</p>
<h6 id="blueprint-requirements">BluePrint Requirements:</h6>
<p>I want to manually enter the VM Name.  I don’t want an auto generated name. After the Windows Server VM is created I want to to able to add vCenter TAGS to VM, make some OS changes, and install software based on values entered on the BluePrint.</p>
<h6 id="what-i-created-to-accomplish-the-requirements">What I created to accomplish the requirements:</h6>
<p>Created a BluePrint. See included code and screen shot.</p>
<p>Created a PowerShell Action. See included code and screen shot.</p>
<p>Created a Subscription. See Screenshot.</p>
<h6 id="sample-code-and-screen-shots---">Sample Code and Screen Shots:&mdash;</h6>
<h6 id="blueprint">BluePrint:</h6>
<figure><a class="lightgallery" href="/vra81-abx-ps/vra81-01.jpg" title="/vra81-abx-ps/vra81-01.jpg" data-thumbnail="/vra81-abx-ps/vra81-01.jpg" data-sub-html="<h2>Click to see Larger Image</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/vra81-abx-ps/vra81-01.jpg"
            data-srcset="/vra81-abx-ps/vra81-01.jpg, /vra81-abx-ps/vra81-01.jpg 1.5x, /vra81-abx-ps/vra81-01.jpg 2x"
            data-sizes="auto"
            alt="/vra81-abx-ps/vra81-01.jpg" width="1101" height="1070" />
    </a><figcaption class="image-caption">Click to see Larger Image</figcaption>
    </figure>
<p>The properties under resources in the yaml code can be used like parameters in a PowerShell script. Since I have a background in PowerShell that is how I am using the properties. When you deploy the BluePrint the values entered that I defined will not be used until the Action runs. The Action will run after the “Compute post provision” event is triggered with the subscription. Those values will be passed from the BluePrint to the Action.  Just like passing parameters to a PS script.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1"># This is the yaml code for the BluePrint</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Created by vCrocs.info</span>
</span></span><span class="line"><span class="cl"><span class="n">formatVersion</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">inputs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">cpuCount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="n">integer</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">virtual</span> <span class="n">processors</span>
</span></span><span class="line"><span class="cl">    <span class="n">default</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">  <span class="n">totalMemoryMB</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="n">integer</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="n">Machine</span> <span class="n">virtual</span> <span class="n">memory</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">Megabytes</span>
</span></span><span class="line"><span class="cl">    <span class="n">default</span><span class="p">:</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl">  <span class="n">VMname</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="n">string</span>
</span></span><span class="line"><span class="cl">    <span class="n">default</span><span class="p">:</span> <span class="n">DBH00</span>
</span></span><span class="line"><span class="cl">  <span class="n">SQL</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="n">boolean</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="n">Is</span> <span class="n">this</span> <span class="n">a</span> <span class="n">SQL</span> <span class="n">Server</span><span class="err">?</span>
</span></span><span class="line"><span class="cl">    <span class="n">default</span><span class="p">:</span> <span class="bp">false</span>
</span></span><span class="line"><span class="cl">  <span class="n">D</span><span class="o">-</span><span class="n">Drive</span><span class="o">-</span><span class="n">Size</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="n">integer</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="s1">&#39;Enter D:\ Size in GB&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">default</span><span class="p">:</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="n">minimum</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">    <span class="n">maximum</span><span class="p">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">  <span class="n">TEST</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="n">string</span>
</span></span><span class="line"><span class="cl">    <span class="k">enum</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="o">-</span> <span class="s1">&#39;Yes&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="o">-</span> <span class="s1">&#39;No&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">resources</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">Cloud_vSphere_Machine_1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span><span class="p">:</span> <span class="n">Cloud</span><span class="o">.</span><span class="n">vSphere</span><span class="o">.</span><span class="n">Machine</span>
</span></span><span class="line"><span class="cl">    <span class="n">properties</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;${input.VMname}&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">SQL</span><span class="p">:</span> <span class="s1">&#39;${input.SQL}&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">DDRive</span><span class="p">:</span> <span class="s1">&#39;${input.D-Drive-Size}&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">imageRef</span><span class="p">:</span> <span class="mi">2019</span><span class="o">-</span><span class="n">TEMPLATE</span>
</span></span><span class="line"><span class="cl">      <span class="n">cpuCount</span><span class="p">:</span> <span class="s1">&#39;${input.cpuCount}&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">totalMemoryMB</span><span class="p">:</span> <span class="s1">&#39;${input.totalMemoryMB}&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">TEST</span><span class="p">:</span> <span class="s1">&#39;${input.TEST}&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">constraints</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="o">-</span> <span class="n">tag</span><span class="p">:</span> <span class="s1">&#39;quick_start_run:1&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>&mdash;Using the Inputs Screen helps you build the BluePrint yaml code.  I found this very useful since I am still learning the proper yaml formatting.</p>
<figure><a class="lightgallery" href="/vra81-abx-ps/vra81-04.png" title="/vra81-abx-ps/vra81-04.png" data-thumbnail="/vra81-abx-ps/vra81-04.png" data-sub-html="<h2>Click to see Larger Image</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/vra81-abx-ps/vra81-04.png"
            data-srcset="/vra81-abx-ps/vra81-04.png, /vra81-abx-ps/vra81-04.png 1.5x, /vra81-abx-ps/vra81-04.png 2x"
            data-sizes="auto"
            alt="/vra81-abx-ps/vra81-04.png" width="1101" height="1070" />
    </a><figcaption class="image-caption">Click to see Larger Image</figcaption>
    </figure>
<h6 id="action">Action:</h6>
<figure><a class="lightgallery" href="/vra81-abx-ps/vra81-02.jpg" title="/vra81-abx-ps/vra81-02.jpg" data-thumbnail="/vra81-abx-ps/vra81-02.jpg" data-sub-html="<h2>Click to see Larger Image</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/vra81-abx-ps/vra81-02.jpg"
            data-srcset="/vra81-abx-ps/vra81-02.jpg, /vra81-abx-ps/vra81-02.jpg 1.5x, /vra81-abx-ps/vra81-02.jpg 2x"
            data-sizes="auto"
            alt="/vra81-abx-ps/vra81-02.jpg" width="1101" height="1070" />
    </a><figcaption class="image-caption">Click to see Larger Image</figcaption>
    </figure>
<p>In my PowerShell code I am using Write-Host to help me understand how the BluePrint passes values to the Action. I use to troubleshoot and understand how it is working. I am able to take values from the payload customProperties and assign to variables. The customProperties are defined in the BluePrint yaml code as resources/properties. I can then make decisions in the code based on these values.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1"># This is the PowerShell code for the Action</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">handler</span><span class="p">(</span><span class="o">$</span><span class="n">context</span><span class="p">,</span> <span class="o">$</span><span class="n">payload</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&#34;VM Name Created: &#34;</span> <span class="o">$</span><span class="n">payload</span><span class="o">.</span><span class="n">resourceNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&#34;D-DRive Size: &#34;</span> <span class="o">$</span><span class="n">payload</span><span class="o">.</span><span class="n">customProperties</span><span class="o">.</span><span class="n">DDRive</span>
</span></span><span class="line"><span class="cl">    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&#34;SQL: &#34;</span> <span class="o">$</span><span class="n">payload</span><span class="o">.</span><span class="n">customProperties</span><span class="o">.</span><span class="n">SQL</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">VMname</span> <span class="o">=</span> <span class="o">$</span><span class="n">payload</span><span class="o">.</span><span class="n">resourceNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="s2">&#34;VM Name Variable: &#34;</span> <span class="o">$</span><span class="n">VMname</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">SQL</span> <span class="o">=</span> <span class="o">$</span><span class="n">payload</span><span class="o">.</span><span class="n">customProperties</span><span class="o">.</span><span class="n">SQL</span>
</span></span><span class="line"><span class="cl">    <span class="o">$</span><span class="n">DDrive</span> <span class="o">=</span> <span class="o">$</span><span class="n">payload</span><span class="o">.</span><span class="n">customProperties</span><span class="o">.</span><span class="n">DDRive</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#Connect to vCenter</span>
</span></span><span class="line"><span class="cl">    <span class="n">Connect</span><span class="o">-</span><span class="n">VIServer</span> <span class="o">-</span><span class="n">server</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span> <span class="o">-</span><span class="n">User</span> <span class="s2">&#34;administrator@vsphere.local&#34;</span> <span class="o">-</span><span class="n">Password</span> <span class="s2">&#34;VMware#1&#34;</span> <span class="o">-</span><span class="n">Protocol</span> <span class="n">https</span> <span class="o">-</span><span class="n">Force</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">#Assign Tag to new VM</span>
</span></span><span class="line"><span class="cl">    <span class="n">New</span><span class="o">-</span><span class="n">TagAssignment</span> <span class="o">-</span><span class="n">Tag</span> <span class="s1">&#39;TAG-vRA-Built&#39;</span> <span class="o">-</span><span class="n">Entity</span> <span class="o">$</span><span class="n">VMname</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">$</span><span class="n">SQL</span> <span class="o">-</span><span class="n">eq</span> <span class="s1">&#39;true&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">New</span><span class="o">-</span><span class="n">TagAssignment</span> <span class="o">-</span><span class="n">Tag</span> <span class="s1">&#39;TAG-SQL-Server&#39;</span> <span class="o">-</span><span class="n">Entity</span> <span class="o">$</span><span class="n">VMname</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="c1"># End if</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="o">$</span><span class="n">payload</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="subscription">Subscription:</h6>
<figure><a class="lightgallery" href="/vra81-abx-ps/vra81-03.png" title="/vra81-abx-ps/vra81-03.png" data-thumbnail="/vra81-abx-ps/vra81-03.png" data-sub-html="<h2>Click to see Larger Image</h2>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="/vra81-abx-ps/vra81-03.png"
            data-srcset="/vra81-abx-ps/vra81-03.png, /vra81-abx-ps/vra81-03.png 1.5x, /vra81-abx-ps/vra81-03.png 2x"
            data-sizes="auto"
            alt="/vra81-abx-ps/vra81-03.png" width="1101" height="1070" />
    </a><figcaption class="image-caption">Click to see Larger Image</figcaption>
    </figure>
<h6 id="lets-compare-vra-76-vs-81">Lets compare vRA 7.6 vs 8.1</h6>
<p>vRA 7.6:</p>
<p>I would create a BluePrint with a custom form in vRA 7.6. I would pass the field values from the custom form as parameters to a PowerShell script on a PowerShell Host.</p>
<p>vRA 8.1:</p>
<p>Using ABX and a subscription in vRA 8.1 eliminates the need to have a Windows PowerShell host and the PowerShell script has no parameters. The vRA 8.x appliance is the PowerShell Host. Less moving parts to complete a Windows Server Build in vRA 8.1.</p>
<h6 id="lessons-learned">Lessons Learned:</h6>
<ul>
<li>I will need to learn yaml.</li>
<li>The process to Create BluePrints will be much different in vRA 8.x.</li>
<li>A lot of the PowerShell code and logic I use in vRA 7.6 will be able to be reused.</li>
<li>I will not need as many VMs for the installation and administration of vRA 8.x.</li>
</ul>
<hr>
<ul>
<li>If you like wearing Crocs and want to get a pair like I wear, follow this link to Amazon:
<a target="_blank" href="https://www.amazon.com/dp/B001V7Z27W?psc=1&amp;ref=ppx_yo2ov_dt_b_product_details&_encoding=UTF8&tag=vcrocs-20&linkCode=ur2&linkId=fa4c787c9ab59a9b8a54b48c402b8517&camp=1789&creative=9325">My Favorite Crocs</a></li>
<li>If you found this Blog article useful and it helped you, Buy me a coffee to start my day.</li>
</ul>
<center>
<script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="dalehassinger" data-color="#FFDD00" data-emoji=""  data-font="Cookie" data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff" ></script>
</center>
<hr></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-10-17</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://www.vcrocs.info/vra81-abx-ps/" data-title="vRealize Automation 8.1 - PowerShell ABX" data-via="dalehassinger" data-hashtags="PowerShell,vRA,ABX,vRealize Automation,VMware Aria"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://www.vcrocs.info/vra81-abx-ps/" data-hashtag="PowerShell"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://www.vcrocs.info/vra81-abx-ps/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/powershell/">PowerShell</a>,&nbsp;<a href="/tags/vra/">VRA</a>,&nbsp;<a href="/tags/abx/">ABX</a>,&nbsp;<a href="/tags/vrealize-automation/">VRealize Automation</a>,&nbsp;<a href="/tags/vmware-aria/">VMware Aria</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/hugo/" class="prev" rel="prev" title="Hugo | Static Site Generator"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Hugo | Static Site Generator</a>
            <a href="/it-reality/" class="next" rel="next" title="What is vRealize Automation - Episode 21">What is vRealize Automation - Episode 21<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Designed | Developed By vCROCS</div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">| Dale Hassinger</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://www.vCROCS.info" target="_blank">www.vCROCS.info</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://vcrocs.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true,"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-KSLC6FHF36');
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-KSLC6FHF36" async></script></body>
</html>
