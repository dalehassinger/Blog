<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>Alerts - Tag - vCROCS</title>
        <link>https://www.vcrocs.info/tags/alerts/</link>
        <description>Alerts - Tag - vCROCS</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><managingEditor>Dale.Hassinger@vCROCS.info (| Dale Hassinger)</managingEditor>
            <webMaster>Dale.Hassinger@vCROCS.info (| Dale Hassinger)</webMaster><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Sun, 17 Mar 2024 00:00:00 &#43;0000</lastBuildDate><atom:link href="https://www.vcrocs.info/tags/alerts/" rel="self" type="application/rss+xml" /><item>
    <title>VMware Aria Automation | How to send messages and updates</title>
    <link>https://www.vcrocs.info/aria-automation-messages-updates/</link>
    <pubDate>Sun, 17 Mar 2024 00:00:00 &#43;0000</pubDate>
    <author>Dale Hassinger</author>
    <guid>https://www.vcrocs.info/aria-automation-messages-updates/</guid>
    <description><![CDATA[<p><strong>How to send messages/updates to a Microsoft Teams Channel or Google Spaces.</strong></p>
<hr>
<blockquote>
<p>&ldquo;If everyone is moving forward together, then success takes care of itself.‚Äù - Henry Ford</p>
</blockquote>
<hr>
<h6 id="vmware-aria-automation">VMware Aria Automation</h6>
<p>Whenever new VMs are deployed or Day 2 operations are executed via the VMware Aria Automation Catalog, I find it crucial to update our team through a common messaging platform about the ongoing creations or modifications. In this blog, I&rsquo;ll demonstrate how to dispatch notifications to both Microsoft Teams and Google Spaces via a Webhook. This technique can be adapted for any messaging service such as Slack, Zoom, Discord, etc., by simply altering the JSON body formatting code and creating a Webhook for message delivery.</p>
<p>I will guide you through the process of sending alerts from VMware Aria Automation utilizing ABX Actions and Orchestrator Workflows. Though the procedure remains largely the same, there are minor variations in acquiring Property Values. Presenting both methods offers you, the Automation Specialists, the freedom to choose the approach that seamlessly integrates into your workflows. My philosophy in automation is that there are countless ways to achieve the same outcome.</p>
<hr>
<p>In this blog, I&rsquo;ll walk you through the creation of a new virtual machine (VM). At the onset of the build process, I have configured an Extensibility Subscription that triggers the sending of notifications to both Microsoft Teams and Google Spaces. This is accomplished through the use of an ABX Action and an Orchestrator Workflow.</p>
<hr>
<p>Besides notifying your team when a new VM is created, I&rsquo;ll demonstrate how to dispatch a message through an Orchestrator Workflow for a Day 2 Automation process.</p>
<hr>
<h6 id="create-a-new-vm-and-send-message">Create a New VM and Send Message</h6>
<p><strong>Steps:</strong></p>
<ol>
<li>Within the Design section of Aria Automation, create a template. For the purpose of this tutorial, we will construct a straightforward Rocky Linux VM. | Refer to <a href="#screen-shot-01">Screen Shot 1</a>.</li>
<li>Ensure that all properties you wish to include in your notification are incorporated into the template&rsquo;s YAML code. These property values will be transmitted to both ABX Actions and Orchestrator Workflows. | Refer to <a href="#screen-shot-02">Screen Shot 2</a>.
<ul>
<li>You have the flexibility to include any property in your messages, provided it is specified in the template&rsquo;s YAML code.</li>
</ul>
</li>
<li>Proceed to set up an Extensibility Action. | See <a href="#screen-shot-03">Screen Shot 3</a> and <a href="#screen-shot-04">Screen Shot 4</a>.</li>
<li>Establish an Extensibility Subscription that will initiate the ABX Action or Orchestrator Workflow as required. | Refer to <a href="#screen-shot-05">Screen Shot 5</a>.</li>
<li>Here&rsquo;s an example of how to define a subscription. | See <a href="#screen-shot-06">Screen Shot 6</a>.</li>
<li>Initiate the creation of an Orchestrator Workflow. | Refer to <a href="#screen-shot-07">Screen Shot 7</a>.
<ul>
<li>Incorporate an input property into the Orchestrator Workflow. | See <a href="#screen-shot-08">Screen Shot 8</a>.</li>
<li>Outline the schema within the Orchestrator Workflow. | Refer to <a href="#screen-shot-09">Screen Shot 9</a>.</li>
<li>Inject the necessary code into the Orchestrator Workflow. | See <a href="#screen-shot-10">Screen Shot 10</a> and <a href="#screen-shot-11">Screen Shot 11</a>.</li>
</ul>
</li>
<li>Deploy a new VM and confirm that the Extensibility Subscription successfully triggered the ABX Action you defined.</li>
<li>Check your preferred messaging system to ensure the notification was received.
<ul>
<li>Example of a Google Spaces Message | Refer to <a href="#screen-shot-12">Screen Shot 12</a>.</li>
<li>Example of a Microsoft Teams Message | See <a href="#screen-shot-13">Screen Shot 13</a>.</li>
</ul>
</li>
<li>If all steps were executed successfully, it&rsquo;s time for a celebration!</li>
<li><a href="#screen-shot-14">Screen Shot 14</a> illustrates the process of creating a Google Spaces Webhook.</li>
</ol>
<hr>
<h6 id="orchestrator-workflow-day-2-automation-and-send-message">Orchestrator Workflow Day 2 Automation and Send Message</h6>
<p><strong>Steps:</strong></p>
<ol>
<li>Initiate the creation of an Orchestrator Workflow. Creating a new Workflow is the same for Day 2 Automation Processes as when a Workflow was created for building a New VM. | Refer to <a href="#screen-shot-07">Screen Shot 7</a>.
<ul>
<li>Incorporate an input property into the Orchestrator Workflow for every question needed to complete the Day 2 Automation. | See <a href="#screen-shot-15">Screen Shot 15</a>.</li>
<li>Inject the necessary code into the Orchestrator Workflow. | See <a href="#screen-shot-16">Screen Shot 16</a>.</li>
</ul>
</li>
<li>Run the Workflow and confirm that the code successfully ran and created the message .</li>
<li>Check your preferred messaging system to ensure the notification was received. The Messages with look the same as when you created a New VM. YOU define what information is shown.
<ul>
<li>Example of a Google Spaces Message | Refer to <a href="#screen-shot-12">Screen Shot 12</a>.</li>
<li>Example of a Microsoft Teams Message | See <a href="#screen-shot-13">Screen Shot 13</a>.</li>
</ul>
</li>
<li>If all steps were executed successfully, it&rsquo;s time for a high five!</li>
<li>Example of a Day 2 Automation Microsoft Teams Message | See <a href="#screen-shot-17">Screen Shot 17</a>.</li>
</ol>
<hr>
<h6 id="screen-shots-of-the-steps">Screen Shots of the Steps:</h6>
<h6 id="screen-shot-01">Screen Shot 01:</h6>
<p>Design Template with YAML Code that has all the required Properties.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-01.png" title="/aria-automation-messages-updates/aria-automation-messages-01.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-01.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<p><strong>Design Template Example YAML Code:</strong></p>
<p>This YAML code shows all the Properties that I want to send to a ABX Action or Orchestrator Workflow.</p>
<p><span style="color: red; font-weight: bold;">Click arrow to expand the code:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-YAML" data-lang="YAML"><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">formatVersion</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Ubuntu-20-with-minion</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="m">9</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">CustomizationSpec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l">Customization Specification</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l">Customization-Ubuntu-22</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Customization Spec:&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">VMName</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;VM Name:&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">minLength</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">maxLength</span><span class="p">:</span><span class="w"> </span><span class="m">15</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l">LINUX-U-16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">IP</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="m">192.168.69.16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">BuildTime</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Build Time:&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="l">date-time</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">vCenterFolders</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;vCenter Folder:&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l">Blogs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">$dynamicEnum</span><span class="p">:</span><span class="w"> </span><span class="l">/data/vro-actions/TAM/DBH_vCenter_Folders</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Cloud_vSphere_Machine_1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Cloud.vSphere.Machine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">vCenter-ubuntu-20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">flavor</span><span class="p">:</span><span class="w"> </span><span class="l">vCenter-1CPU-2GB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">${input.VMName}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">BuildTime</span><span class="p">:</span><span class="w"> </span><span class="l">${input.BuildTime}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">folderName</span><span class="p">:</span><span class="w"> </span><span class="l">${input.vCenterFolders}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">customizationSpec</span><span class="p">:</span><span class="w"> </span><span class="l">${input.CustomizationSpec}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">vmIP</span><span class="p">:</span><span class="w"> </span><span class="l">${input.IP}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">remoteAccess</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">authentication</span><span class="p">:</span><span class="w"> </span><span class="l">usernamePassword</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">administrator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l">VMware1!</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">constraints</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster:PROD</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">network</span><span class="p">:</span><span class="w"> </span><span class="l">${resource.Cloud_vSphere_Network_1.id}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">assignment</span><span class="p">:</span><span class="w"> </span><span class="l">static</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="l">${input.IP}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Cloud_vSphere_Network_1</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Cloud.vSphere.Network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">properties</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">networkType</span><span class="p">:</span><span class="w"> </span><span class="l">existing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">constraints</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l">Network:vCenter-VMs</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h6 id="screen-shot-02">Screen Shot 02:</h6>
<p>Highlight of YAML Code showing Properties.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-02.png" title="/aria-automation-messages-updates/aria-automation-messages-02.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-02.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-03">Screen Shot 03:</h6>
<p>Where to create Extensibility ABX Actions.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-03-1.png" title="/aria-automation-messages-updates/aria-automation-messages-03-1.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-03-1.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-04">Screen Shot 04:</h6>
<p>Example Extensibility ABX Action.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-03-2.png" title="/aria-automation-messages-updates/aria-automation-messages-03-2.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-03-2.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<p><strong>Extensibility ABX Action Code:</strong></p>
<p>Code Snippets.</p>
<ul>
<li>Each ABX Action starts with identical code to retrieve Property Values.</li>
<li>The variation arises in the methodology of dispatching this information to the respective messaging systems.</li>
</ul>
<p>Here&rsquo;s an example script for sending notifications to Microsoft Teams.</p>
<p><span style="color: red; font-weight: bold;">Click arrow to expand the code:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">handler($context</span><span class="p">,</span> <span class="nv">$inputs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Build PowerShell variables</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="n">resourceNames</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">resourceNames</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">image</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$image</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$image</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">image</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">flavor</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$flavor</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$flavor</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">flavor</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">folderName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$folder</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$folder</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">folderName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">vmIP</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmIP</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmIP</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">vmIP</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">__metadata</span><span class="p">.</span><span class="n">userName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$userName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$userName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">__metadata</span><span class="p">.</span><span class="py">userName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--vmName:&#34;</span><span class="nv">$vmName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;---image:&#34;</span><span class="nv">$image</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--flavor:&#34;</span><span class="nv">$flavor</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--folder:&#34;</span><span class="nv">$folder</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;userName:&#34;</span><span class="nv">$userName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;----vmIP:&#34;</span><span class="nv">$vmIP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># --- [ Start Add Alert to Teams Channel ] ---</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c"># Define the webhook URL</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$webhookUrl</span> <span class="p">=</span> <span class="s1">&#39;https://vcrocs.webhook.office.com/webhookb2/ac73a8c3-bd4572@015568c1-bbe7-hack-me-4050-add6-6f36b7b44adb/IncomingWebhook/b41cd4d2f-hack-you-12/925b-9960-4590-9251-65db25f05419&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># --- Create the message card</span>
</span></span><span class="line"><span class="cl"><span class="nv">$messageCard</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;@type&#34;</span>    <span class="p">=</span> <span class="s2">&#34;MessageCard&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;@context&#34;</span> <span class="p">=</span> <span class="s2">&#34;http://schema.org/extensions&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;summary&#34;</span>  <span class="p">=</span> <span class="s2">&#34;Issue 176715375&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;sections&#34;</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;activityTitle&#34;</span>    <span class="p">=</span> <span class="s2">&#34;vRA Automated VM Build:&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;facts&#34;</span>            <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM Name:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$vmName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM IP:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$vmIP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;Created By:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$userName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM Image:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$image</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;vCenter Folder:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$folder</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM Flavor:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$flavor</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;markdown&#34;</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="mf">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Send the message card</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="nv">$webhookUrl</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="s1">&#39;application/json&#39;</span> <span class="n">-Body</span> <span class="nv">$messageCard</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$outPut</span> <span class="p">=</span> <span class="s2">&#34;Done&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$outPut</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<p>This code is to send a message to Google Spaces.</p>
<p><span style="color: red; font-weight: bold;">Click arrow to expand the code:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">handler($context</span><span class="p">,</span> <span class="nv">$inputs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Build PowerShell variables</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="n">resourceNames</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">resourceNames</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">image</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$image</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$image</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">image</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">flavor</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$flavor</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$flavor</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">flavor</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">folderName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$folder</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$folder</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">folderName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">vmIP</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmIP</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmIP</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">vmIP</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">__metadata</span><span class="p">.</span><span class="n">userName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$userName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$userName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">__metadata</span><span class="p">.</span><span class="py">userName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--vmName:&#34;</span><span class="nv">$vmName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;---image:&#34;</span><span class="nv">$image</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--flavor:&#34;</span><span class="nv">$flavor</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--folder:&#34;</span><span class="nv">$folder</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;userName:&#34;</span><span class="nv">$userName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;----vmIP:&#34;</span><span class="nv">$vmIP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># --- [ Start Add Alert to Google Chat ] ---</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c"># --- Create json body for Google Alert   </span>
</span></span><span class="line"><span class="cl"><span class="nv">$messageBody</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cards</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">header</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">title</span>    <span class="p">=</span> <span class="s2">&#34;New VM Build&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">sections</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">widgets</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="n">keyValue</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="n">topLabel</span>         <span class="p">=</span> <span class="s2">&#34;VM Name:&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">content</span>          <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$vmname</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">contentMultiline</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="n">keyValue</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="n">topLabel</span>         <span class="p">=</span> <span class="s2">&#34;VM IP:&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">content</span>          <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$vmIP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">contentMultiline</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="n">keyValue</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="n">topLabel</span>         <span class="p">=</span> <span class="s2">&#34;Created By:&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">content</span>          <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$username</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">contentMultiline</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="n">keyValue</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="n">topLabel</span>         <span class="p">=</span> <span class="s2">&#34;VM Image:&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">content</span>          <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$image</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">contentMultiline</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="n">keyValue</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="n">topLabel</span>         <span class="p">=</span> <span class="s2">&#34;vCenter Folder:&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">content</span>          <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$folder</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">contentMultiline</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">},</span>
</span></span><span class="line"><span class="cl">                        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="n">keyValue</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="n">topLabel</span>         <span class="p">=</span> <span class="s2">&#34;VM Flavor:&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">content</span>          <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$flavor</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                                <span class="n">contentMultiline</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nv">$jsonMessage</span> <span class="p">=</span> <span class="nv">$messageBody</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="mf">10</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c"># Output the JSON to verify</span>
</span></span><span class="line"><span class="cl">    <span class="c">#$jsonMessage</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Define the webhook URL (replace it with your actual webhook URL)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$webhookUrl</span> <span class="p">=</span> <span class="s1">&#39;https://chat.googleapis.com/v1/spaces/AAAAvSYSmfg/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&amp;token=Vj-NoThfrmjLnkIW_iQRQw71qcE2CGxG1tkjs2ArM7o&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Send the message</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$results</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="nv">$webhookUrl</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-Body</span> <span class="nv">$jsonMessage</span> <span class="n">-ContentType</span> <span class="s2">&#34;application/json&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">#$outPut = &#34;WebHook Date/Time: &#34; + $results.createTime</span>
</span></span><span class="line"><span class="cl">    <span class="c">#Write-Host $outPut</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nv">$outPut</span> <span class="p">=</span> <span class="s2">&#34;Done&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nv">$outPut</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h6 id="screen-shot-05">Screen Shot 05:</h6>
<p>Subscriptions used to start ABX Actions or Orchestrator Workflows.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-03.png" title="/aria-automation-messages-updates/aria-automation-messages-03.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-03.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-06">Screen Shot 06:</h6>
<p>Subscription definition example.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-04.png" title="/aria-automation-messages-updates/aria-automation-messages-04.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-04.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-07">Screen Shot 07:</h6>
<p>Create a new Orchestrator Workflow.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-07.png" title="/aria-automation-messages-updates/aria-automation-messages-07.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-07.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-08">Screen Shot 08:</h6>
<p>Add Input named &ldquo;inputProperties&rdquo; to the Orchestrator Workflow.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-08.png" title="/aria-automation-messages-updates/aria-automation-messages-08.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-08.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-09">Screen Shot 09:</h6>
<p>Create the Orchestrator Workflow Schema.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-09.png" title="/aria-automation-messages-updates/aria-automation-messages-09.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-09.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-10">Screen Shot 10:</h6>
<p>Add the code to the Orchestrator Workflow.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-10.png" title="/aria-automation-messages-updates/aria-automation-messages-10.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-10.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<p><strong>Orchestrator Workflow Code:</strong></p>
<p>Code Examples. At the start of each Orchestrator Workflow, the code for retrieving Property Values is consistent. The variation comes in how the information is sent to each messaging system.</p>
<ul>
<li>For sending messages to Microsoft Teams, use the following code.</li>
<li>To send a message to Google Spaces in a Workflow, apply the same Google Spaces code used in ABX Actions.</li>
<li>The Google Spaces code does not change between ABX Actions and Workflows.</li>
<li>The difference in ABX Actions and Workflows is in the method of obtaining Property Values.</li>
</ul>
<p><span style="color: red; font-weight: bold;">Click arrow to expand the code:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Handler($context</span><span class="p">,</span> <span class="nv">$inputs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Build PowerShell variables</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="n">resourceNames</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">resourceNames</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">image</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$image</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$image</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">image</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">flavor</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$flavor</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$flavor</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">flavor</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">folderName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$folder</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$folder</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">folderName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="n">vmIP</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmIP</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmIP</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">inputProperties</span><span class="p">.</span><span class="py">customProperties</span><span class="p">.</span><span class="py">vmIP</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="n">__metadata_userName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$userName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$userName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">__metadata_userName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--vmName:&#34;</span><span class="nv">$vmName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;---image:&#34;</span><span class="nv">$image</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--flavor:&#34;</span><span class="nv">$flavor</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;--folder:&#34;</span><span class="nv">$folder</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;userName:&#34;</span><span class="nv">$userName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;----vmIP:&#34;</span><span class="nv">$vmIP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Define the webhook URL</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$webhookUrl</span> <span class="p">=</span> <span class="s1">&#39;https://vcrocs.webhook.office.com/webhookb2/ac73a8c3-59a2-hack-me-bd4572@015568c1-bbe7-4050-add6-6f36b7b44adb/IncomingWebhook/b41cd4d2fcbd-hack-you-0212/925be554-9960-4590-9251-65db25f05419&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Create the message card</span>
</span></span><span class="line"><span class="cl"><span class="nv">$messageCard</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;@type&#34;</span>    <span class="p">=</span> <span class="s2">&#34;MessageCard&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;@context&#34;</span> <span class="p">=</span> <span class="s2">&#34;http://schema.org/extensions&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;summary&#34;</span>  <span class="p">=</span> <span class="s2">&#34;Issue 176715375&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;sections&#34;</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;activityTitle&#34;</span>    <span class="p">=</span> <span class="s2">&#34;vRA Automated VM Build:&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;facts&#34;</span>            <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM Name:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$vmName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM IP:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$vmIP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;Created By:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$userName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM Image:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$image</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;vCenter Folder:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$folder</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM Flavor:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$flavor</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;markdown&#34;</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="mf">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Send the message card</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="nv">$webhookUrl</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="s1">&#39;application/json&#39;</span> <span class="n">-Body</span> <span class="nv">$messageCard</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$output</span><span class="p">=</span><span class="vm">@</span><span class="p">{</span><span class="n">status</span> <span class="p">=</span> <span class="s1">&#39;done&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$output</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h6 id="screen-shot-11">Screen Shot 11:</h6>
<p>Code difference between a Orchestrator Workflow and a ABX Action.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-11.png" title="/aria-automation-messages-updates/aria-automation-messages-11.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-11.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="message-examples">Message Examples:</h6>
<h6 id="screen-shot-12">Screen Shot 12:</h6>
<p>When all is configured and functioning properly, the Google Space message containing the New VM Build Details will appear as follows. Quite impressive!</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-google-space.png" title="/aria-automation-messages-updates/aria-automation-messages-google-space.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-google-space.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-13">Screen Shot 13:</h6>
<p>Microsoft Teams Message with New VM Build Details. Very Cool!</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-teams-message.png" title="/aria-automation-messages-updates/aria-automation-messages-teams-message.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-teams-message.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-14">Screen Shot 14:</h6>
<p>How to create a Google Spaces Webhook. Link included below on how to create a Microsoft Teams Webhook.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-12.png" title="/aria-automation-messages-updates/aria-automation-messages-12.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-12.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="start-of-day-2-automation-screen-shots">Start of Day 2 Automation Screen Shots:</h6>
<h6 id="screen-shot-15">Screen Shot 15:</h6>
<p>Add all the required inputs to the Workflow for the Day 2 Automation process.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-15.png" title="/aria-automation-messages-updates/aria-automation-messages-15.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-15.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="screen-shot-16">Screen Shot 16:</h6>
<p>Add the code to the Orchestrator Workflow.</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-16.png" title="/aria-automation-messages-updates/aria-automation-messages-16.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-16.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<p><strong>Orchestrator Workflow Code for Day 2 Automation:</strong></p>
<p>Code Example.</p>
<ul>
<li>The difference between this Workflow for day 2 Automation Code and when I used a Workflow to create a new VM is how you get the input values.</li>
<li>For sending messages to Microsoft Teams, use the following code.</li>
<li>To send a message to Google Spaces in a Workflow, apply the same Google Spaces code used in ABX Actions.</li>
<li>The Google Spaces code does not change between ABX Actions and Workflows.</li>
<li>The difference in ABX Actions and Workflows is in the method of obtaining Property Values.</li>
</ul>
<p><span style="color: red; font-weight: bold;">Click arrow to expand the code:</span></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PowerShell" data-lang="PowerShell"><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span><span class="w"> </span><span class="nb">Handler($context</span><span class="p">,</span> <span class="nv">$inputs</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Build PowerShell variables</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="n">vmName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$vmName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">vmName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="n">snapName</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$snapName</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$snapName</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">snapName</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(!</span><span class="nv">$inputs</span><span class="p">.</span><span class="n">snapDescription</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$snapDescription</span> <span class="p">=</span> <span class="s2">&#34;NA&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$snapDescription</span> <span class="p">=</span> <span class="nv">$inputs</span><span class="p">.</span><span class="py">snapDescription</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;---------vmName:&#34;</span><span class="nv">$vmName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;-------snapName:&#34;</span><span class="nv">$snapName</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Write-Host</span> <span class="s2">&#34;snapDescription:&#34;</span><span class="nv">$snapDescription</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Define the webhook URL</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$webhookUrl</span> <span class="p">=</span> <span class="s1">&#39;https://vcrocs.webhook.office.com/webhookb2/ac73a8c3-hack-me-e2fbd4572@015568c1-bbe7-4050-add6-6f36b7b44adb/IncomingWebhook/b41cd4d2fcb-hack-you-2/925be554-9960-4590-9251-65db25f05419&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Create the message card</span>
</span></span><span class="line"><span class="cl"><span class="nv">$messageCard</span> <span class="p">=</span> <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;@type&#34;</span>    <span class="p">=</span> <span class="s2">&#34;MessageCard&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;@context&#34;</span> <span class="p">=</span> <span class="s2">&#34;http://schema.org/extensions&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;summary&#34;</span>  <span class="p">=</span> <span class="s2">&#34;Issue 176715375&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;sections&#34;</span> <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;activityTitle&#34;</span>    <span class="p">=</span> <span class="s2">&#34;VM SNAP Shot:&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;facts&#34;</span>            <span class="p">=</span> <span class="vm">@</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;VM Name:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$vmName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;Snap Name:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$snapName</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="vm">@</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;name&#34;</span>  <span class="p">=</span> <span class="s2">&#34;Snap Description:&#34;</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;value&#34;</span> <span class="p">=</span> <span class="s2">&#34;</span><span class="nv">$snapDescription</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;markdown&#34;</span> <span class="p">=</span> <span class="vm">$true</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="mf">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Send the message card</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="nv">$webhookUrl</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="s1">&#39;application/json&#39;</span> <span class="n">-Body</span> <span class="nv">$messageCard</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># Use this section to add the code to do whatever day 2 process you want to run</span>
</span></span><span class="line"><span class="cl">    <span class="c"># --- Start the Code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c"># --- end the Code</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$output</span><span class="p">=</span><span class="vm">@</span><span class="p">{</span><span class="n">status</span> <span class="p">=</span> <span class="s1">&#39;done&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$output</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h6 id="screen-shot-17">Screen Shot 17:</h6>
<p>Microsoft Teams Message with Day 2 Automation Details. Awesome!</p>
<figure><a class="lightgallery" href="/aria-automation-messages-updates/aria-automation-messages-17.png" title="/aria-automation-messages-updates/aria-automation-messages-17.png" data-thumbnail="/aria-automation-messages-updates/aria-automation-messages-17.png" data-sub-html="<h2>Click to see Larger Image of Screen Shot</h2>">
        
    </a><figcaption class="image-caption">Click to see Larger Image of Screen Shot</figcaption>
    </figure>
<hr>
<h6 id="links-to-resources-discussed-is-this-blog-post">Links to resources discussed is this Blog Post:</h6>
<ul>
<li><a href="https://learn.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook?tabs=newteams%2Cdotnet" target="_blank" rel="noopener noreffer ">Link to learn how to create a Microsoft Teams Webhook.</a></li>
<li><a href="https://github.com/dalehassinger/unlocking-the-potential/" target="_blank" rel="noopener noreffer ">Link to my GitHub Repository for sample code like what is included in this Blog Post.</a></li>
</ul>
<hr>
<h6 id="aria-automation-version-used-for-blog-post">Aria Automation Version used for Blog Post:</h6>
<p>VMware Aria Automation 8.16.0 was used for this Blog Post. When new versions of VMware Aria Automation are released, the code or process may need to be changed.</p>
<hr>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>Info<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">In my blogs, I often emphasize that there are multiple methods to achieve the same objective. This article presents just one of the many ways you can tackle this task. I&rsquo;ve shared what I believe to be an effective approach for this particular use case, but keep in mind that every organization and environment varies. There&rsquo;s no definitive right or wrong way to accomplish the tasks discussed in this article.</div>
        </div>
    </div>
<hr>
<ul>
<li>If you found this blog article helpful and it assisted you, consider buying me a coffee to kickstart my day.</li>
</ul>
<center>
<script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="dalehassinger" data-color="#FFDD00" data-emoji=""  data-font="Cookie" data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff" ></script>
</center>
<hr>]]></description>
</item>
</channel>
</rss>
